(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     27188,        593]
NotebookOptionsPosition[     26235,        557]
NotebookOutlinePosition[     26587,        573]
CellTagsIndexPosition[     26544,        570]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{
   "$Path", ",", 
    "\"\</Users/jonas/Google Drive/Uni/_Master/2. Semester/Kryptografische \
Protokolle/Mathematica\>\""}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Get", "[", "\"\<KryptoNumberTheory`\>\"", "]"}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"Bestimmt", " ", "Pimzahl", " ", "q", " ", "sodass", " ", "p"}], 
     "=", 
     RowBox[{
      RowBox[{"2", "q"}], "+", 
      RowBox[{"1", " ", "und", " ", "p", " ", "ebenfalls", " ", "prim"}]}]}], 
    ",", " ", 
    RowBox[{
     RowBox[{"startet", " ", "Suche", " ", "mit", " ", "der", " ", "n"}], "-", 
     RowBox[{"ten", " ", "Primzahl"}]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getPQ", "[", "n_", "]"}], ":=", 
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"q", "=", 
      RowBox[{"Prime", "[", "n", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"PrimeQ", "[", 
         RowBox[{
          RowBox[{"2", "*", "q"}], "+", "1"}], "]"}], "\[NotEqual]", "True"}],
        ",", "\[IndentingNewLine]", 
       RowBox[{"q", "=", 
        RowBox[{"NextPrime", "[", "q", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "q", "]"}]}], ")"}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Bestimmt", " ", "Element", " ", "mit", " ", "Ordnung", " ", "q", " ", 
    "in", " ", "in", " ", "einer", " ", "Gruppe", " ", "gr", " ", "der", " ", 
    "Ordnung", " ", "n"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"getQElement", "[", 
   RowBox[{"q_", ",", " ", "gr_", ",", " ", "n_"}], "]"}], ":=", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"i", "=", "2"}], ",", " ", 
      RowBox[{"i", "\[LessEqual]", 
       RowBox[{"Length", "[", "gr", "]"}]}], ",", 
      RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Mod", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"gr", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "^", "q"}], ",", "n"}], "]"}], 
         "\[Equal]", "1"}], ",", 
        RowBox[{"Return", "[", 
         RowBox[{"gr", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "]"}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Return", "[", 
     RowBox[{"-", "1"}], "]"}]}], ")"}]}]}], "Input",
 CellChangeTimes->{{3.772609394858596*^9, 3.7726094769329433`*^9}, {
   3.77260952268781*^9, 3.772609682634251*^9}, {3.772609719093092*^9, 
   3.772609810649605*^9}, {3.772609862923152*^9, 3.772609948730104*^9}, {
   3.772610132716488*^9, 3.7726101732460012`*^9}, {3.772610208883223*^9, 
   3.7726102470345984`*^9}, {3.7726106576558123`*^9, 3.772610765874474*^9}, {
   3.7726108079718113`*^9, 3.772610819659814*^9}, {3.772611064309366*^9, 
   3.772611380931849*^9}, {3.772611411599101*^9, 3.77261145649448*^9}, {
   3.772611499336021*^9, 3.7726115051597548`*^9}, {3.772611540074041*^9, 
   3.772611598378841*^9}, {3.7726116648921423`*^9, 3.772611717164589*^9}, {
   3.772612325135235*^9, 3.772612351471817*^9}, {3.772612445699667*^9, 
   3.772612451211526*^9}, {3.7726125494535713`*^9, 3.772612628511915*^9}, {
   3.772612849391474*^9, 3.772612962514843*^9}, {3.772613001949337*^9, 
   3.772613004765381*^9}, {3.772623063055798*^9, 3.7726230692216043`*^9}, {
   3.772623151662665*^9, 3.772623153473723*^9}, {3.772623438610393*^9, 
   3.77262347512256*^9}, 3.772623604431985*^9, {3.7726236573544693`*^9, 
   3.7726237137678757`*^9}, {3.772624312115623*^9, 3.7726243669488697`*^9}, {
   3.77262705291521*^9, 3.7726270536595078`*^9}, {3.772627475807465*^9, 
   3.7726274795274057`*^9}, {3.7726275097686777`*^9, 3.772627515288376*^9}, {
   3.7726279799358463`*^9, 3.772627988870241*^9}, {3.7726285550733633`*^9, 
   3.7726285565670643`*^9}, {3.773314033595409*^9, 3.773314039540847*^9}, {
   3.7733186344928503`*^9, 3.773318655512295*^9}, 3.7733187012023*^9, {
   3.773318928760762*^9, 3.773318929217196*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"PRES", " ", "based", " ", "on", " ", "El"}], "-", "Gamal", "-", 
    "PKES"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"PlainText", " ", "=", " ", "5"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<Plaintext M = \>\"", ",", " ", "PlainText"}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"q", "=", 
     RowBox[{"getPQ", "[", "10", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"p", "=", 
     RowBox[{
      RowBox[{"2", "*", "q"}], "+", "1"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{
     "\"\<q = \>\"", ",", "q", ",", " ", "\"\< und p = \>\"", ",", "p"}], 
     "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Zp", "=", 
     RowBox[{"generateMultiplicativeGroup", "[", "p", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<Gruppe Zp = \>\"", ",", " ", "Zp"}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"g", "=", 
     RowBox[{"getQElement", "[", 
      RowBox[{"q", ",", "Zp", ",", "p"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<g = \>\"", ",", "g"}], "]"}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"sKa", " ", "=", " ", 
     RowBox[{"RandomInteger", "[", 
      RowBox[{"{", 
       RowBox[{"1", ",", 
        RowBox[{"q", "-", "1"}]}], "}"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sKb", " ", "=", " ", 
     RowBox[{"RandomInteger", "[", 
      RowBox[{"{", 
       RowBox[{"1", ",", 
        RowBox[{"q", "-", "1"}]}], "}"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pKa", "=", 
     RowBox[{"Mod", "[", 
      RowBox[{
       RowBox[{"g", "^", "sKa"}], ",", "p"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pKb", " ", "=", " ", 
     RowBox[{"Mod", "[", 
      RowBox[{
       RowBox[{"g", "^", "sKb"}], ",", "p"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{
     "\"\<sKa = \>\"", ",", " ", "sKa", ",", " ", "\"\< sKb = \>\"", ",", " ",
       "sKb", ",", " ", "\"\< pKa = \>\"", ",", " ", "pKa", ",", " ", 
      "\"\< pKb = \>\"", ",", " ", "pKb"}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"r", " ", "=", " ", 
     RowBox[{"RandomInteger", "[", 
      RowBox[{"{", 
       RowBox[{"1", ",", 
        RowBox[{"q", "-", "1"}]}], "}"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<r = \>\"", ",", " ", "r"}], " ", "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CipherText1A", " ", "=", " ", 
     RowBox[{"Mod", "[", 
      RowBox[{
       RowBox[{"g", "^", "r"}], ",", "p"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CipherText2A", " ", "=", 
     RowBox[{"Mod", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"pKa", "^", "r"}], "*", "PlainText"}], ",", "p"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{
     "\"\<C = (\>\"", ",", "CipherText1A", ",", " ", "\"\<, \>\"", ",", " ", 
      "CipherText2A", ",", " ", "\"\<)\>\""}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rekAB", " ", "=", " ", 
     RowBox[{"Mod", "[", 
      RowBox[{
       RowBox[{"sKa", "*", 
        RowBox[{"getModularMultiplicativeInverse", "[", 
         RowBox[{"sKb", ",", "q"}], "]"}]}], ",", "q"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<ReKey = \>\"", ",", " ", "rekAB"}], "]"}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.772609186731023*^9, 3.772609353920347*^9}, {
   3.772609960801903*^9, 3.772609977138116*^9}, {3.772610012060671*^9, 
   3.772610037869439*^9}, {3.772610075423439*^9, 3.772610090455678*^9}, {
   3.7726101835685253`*^9, 3.7726101900634327`*^9}, {3.7726103172522717`*^9, 
   3.772610321955801*^9}, {3.772611628570178*^9, 3.772611645210485*^9}, {
   3.7726117206055717`*^9, 3.772611762822462*^9}, {3.772611811999611*^9, 
   3.772611893267371*^9}, {3.772611944502269*^9, 3.77261206241536*^9}, {
   3.772612104272614*^9, 3.772612160194619*^9}, {3.7726122118673487`*^9, 
   3.772612242214304*^9}, {3.772612280630541*^9, 3.772612299325519*^9}, {
   3.77261315283879*^9, 3.772613178529117*^9}, {3.772613282060227*^9, 
   3.77261333561911*^9}, {3.7726134583996363`*^9, 3.772613468694418*^9}, {
   3.772613510552594*^9, 3.772613558273136*^9}, {3.772613673141362*^9, 
   3.772613740527129*^9}, {3.772613873467681*^9, 3.772613892979403*^9}, {
   3.772613992895233*^9, 3.772614036464569*^9}, {3.772614134460535*^9, 
   3.772614307841299*^9}, {3.772614345532104*^9, 3.772614421186392*^9}, {
   3.772614476300403*^9, 3.772614485732936*^9}, {3.772614943602302*^9, 
   3.77261496685881*^9}, {3.772615034470673*^9, 3.772615078045281*^9}, {
   3.772615263967299*^9, 3.772615330820912*^9}, {3.772615404253129*^9, 
   3.77261542307901*^9}, {3.772615513218388*^9, 3.7726155180823174`*^9}, {
   3.77261559646881*^9, 3.772615604045167*^9}, {3.772622683673491*^9, 
   3.7726227057878637`*^9}, {3.77262322310233*^9, 3.772623223225768*^9}, {
   3.772623260716226*^9, 3.7726232744511967`*^9}, {3.772623316109825*^9, 
   3.7726233240848007`*^9}, {3.7726244112873783`*^9, 3.772624439005254*^9}, {
   3.7726244791830063`*^9, 3.772624493926167*^9}, {3.7726245492261343`*^9, 
   3.772624557521257*^9}, {3.7726249118769703`*^9, 3.772624921540007*^9}, {
   3.77262497818194*^9, 3.772625174323772*^9}, {3.772625206484283*^9, 
   3.772625362920664*^9}, {3.772625393745212*^9, 3.7726255009417553`*^9}, {
   3.772625800287951*^9, 3.772625803375412*^9}, {3.772626784014575*^9, 
   3.772626801942576*^9}, {3.77262683630342*^9, 3.772626836873931*^9}, {
   3.772627175930979*^9, 3.77262717606091*^9}, {3.772627244471438*^9, 
   3.772627376132633*^9}, {3.7726274230659924`*^9, 3.77262742442828*^9}, {
   3.7726275312200947`*^9, 3.7726275632929487`*^9}, {3.772778305157164*^9, 
   3.772778308217573*^9}, {3.773318719872415*^9, 3.77331872097362*^9}, 
   3.773318970921351*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Plaintext M = \"\>", "\[InvisibleSpace]", "5"}],
  SequenceForm["Plaintext M = ", 5],
  Editable->False]], "Print",
 CellChangeTimes->{{3.7726268723921947`*^9, 3.772626886422524*^9}, 
   3.772627056840578*^9, 3.7726270991070747`*^9, 3.772627130174691*^9, {
   3.772627179245577*^9, 3.772627186072956*^9}, {3.7726272472437*^9, 
   3.772627317946089*^9}, {3.772627351991897*^9, 3.772627383050082*^9}, 
   3.77262742718675*^9, 3.772627482351563*^9, {3.772627521804685*^9, 
   3.772627565815549*^9}, {3.772627970921803*^9, 3.772627993530748*^9}, 
   3.772688101762364*^9, 3.77277831286942*^9, 3.77277868380354*^9, {
   3.773314041221697*^9, 3.773314045673312*^9}, 3.77331872348147*^9, 
   3.773318977389785*^9, {3.773319091568604*^9, 3.773319115147163*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"q = \"\>", "\[InvisibleSpace]", "29", 
   "\[InvisibleSpace]", "\<\" und p = \"\>", "\[InvisibleSpace]", "59"}],
  SequenceForm["q = ", 29, " und p = ", 59],
  Editable->False]], "Print",
 CellChangeTimes->{{3.7726268723921947`*^9, 3.772626886422524*^9}, 
   3.772627056840578*^9, 3.7726270991070747`*^9, 3.772627130174691*^9, {
   3.772627179245577*^9, 3.772627186072956*^9}, {3.7726272472437*^9, 
   3.772627317946089*^9}, {3.772627351991897*^9, 3.772627383050082*^9}, 
   3.77262742718675*^9, 3.772627482351563*^9, {3.772627521804685*^9, 
   3.772627565815549*^9}, {3.772627970921803*^9, 3.772627993530748*^9}, 
   3.772688101762364*^9, 3.77277831286942*^9, 3.77277868380354*^9, {
   3.773314041221697*^9, 3.773314045673312*^9}, 3.77331872348147*^9, 
   3.773318977389785*^9, {3.773319091568604*^9, 3.77331911515705*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Gruppe Zp = \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "6", ",", "7",
      ",", "8", ",", "9", ",", "10", ",", "11", ",", "12", ",", "13", ",", 
     "14", ",", "15", ",", "16", ",", "17", ",", "18", ",", "19", ",", "20", 
     ",", "21", ",", "22", ",", "23", ",", "24", ",", "25", ",", "26", ",", 
     "27", ",", "28", ",", "29", ",", "30", ",", "31", ",", "32", ",", "33", 
     ",", "34", ",", "35", ",", "36", ",", "37", ",", "38", ",", "39", ",", 
     "40", ",", "41", ",", "42", ",", "43", ",", "44", ",", "45", ",", "46", 
     ",", "47", ",", "48", ",", "49", ",", "50", ",", "51", ",", "52", ",", 
     "53", ",", "54", ",", "55", ",", "56", ",", "57", ",", "58"}], "}"}]}],
  SequenceForm[
  "Gruppe Zp = ", {0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 
   17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
    36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 
   54, 55, 56, 57, 58}],
  Editable->False]], "Print",
 CellChangeTimes->{{3.7726268723921947`*^9, 3.772626886422524*^9}, 
   3.772627056840578*^9, 3.7726270991070747`*^9, 3.772627130174691*^9, {
   3.772627179245577*^9, 3.772627186072956*^9}, {3.7726272472437*^9, 
   3.772627317946089*^9}, {3.772627351991897*^9, 3.772627383050082*^9}, 
   3.77262742718675*^9, 3.772627482351563*^9, {3.772627521804685*^9, 
   3.772627565815549*^9}, {3.772627970921803*^9, 3.772627993530748*^9}, 
   3.772688101762364*^9, 3.77277831286942*^9, 3.77277868380354*^9, {
   3.773314041221697*^9, 3.773314045673312*^9}, 3.77331872348147*^9, 
   3.773318977389785*^9, {3.773319091568604*^9, 3.7733191151667223`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"g = \"\>", "\[InvisibleSpace]", "1"}],
  SequenceForm["g = ", 1],
  Editable->False]], "Print",
 CellChangeTimes->{{3.7726268723921947`*^9, 3.772626886422524*^9}, 
   3.772627056840578*^9, 3.7726270991070747`*^9, 3.772627130174691*^9, {
   3.772627179245577*^9, 3.772627186072956*^9}, {3.7726272472437*^9, 
   3.772627317946089*^9}, {3.772627351991897*^9, 3.772627383050082*^9}, 
   3.77262742718675*^9, 3.772627482351563*^9, {3.772627521804685*^9, 
   3.772627565815549*^9}, {3.772627970921803*^9, 3.772627993530748*^9}, 
   3.772688101762364*^9, 3.77277831286942*^9, 3.77277868380354*^9, {
   3.773314041221697*^9, 3.773314045673312*^9}, 3.77331872348147*^9, 
   3.773318977389785*^9, {3.773319091568604*^9, 3.7733191151783123`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"sKa = \"\>", "\[InvisibleSpace]", "26", 
   "\[InvisibleSpace]", "\<\" sKb = \"\>", "\[InvisibleSpace]", "23", 
   "\[InvisibleSpace]", "\<\" pKa = \"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\" pKb = \"\>", "\[InvisibleSpace]", "1"}],
  SequenceForm["sKa = ", 26, " sKb = ", 23, " pKa = ", 1, " pKb = ", 1],
  Editable->False]], "Print",
 CellChangeTimes->{{3.7726268723921947`*^9, 3.772626886422524*^9}, 
   3.772627056840578*^9, 3.7726270991070747`*^9, 3.772627130174691*^9, {
   3.772627179245577*^9, 3.772627186072956*^9}, {3.7726272472437*^9, 
   3.772627317946089*^9}, {3.772627351991897*^9, 3.772627383050082*^9}, 
   3.77262742718675*^9, 3.772627482351563*^9, {3.772627521804685*^9, 
   3.772627565815549*^9}, {3.772627970921803*^9, 3.772627993530748*^9}, 
   3.772688101762364*^9, 3.77277831286942*^9, 3.77277868380354*^9, {
   3.773314041221697*^9, 3.773314045673312*^9}, 3.77331872348147*^9, 
   3.773318977389785*^9, {3.773319091568604*^9, 3.773319115189219*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"r = \"\>", "\[InvisibleSpace]", "20"}],
  SequenceForm["r = ", 20],
  Editable->False]], "Print",
 CellChangeTimes->{{3.7726268723921947`*^9, 3.772626886422524*^9}, 
   3.772627056840578*^9, 3.7726270991070747`*^9, 3.772627130174691*^9, {
   3.772627179245577*^9, 3.772627186072956*^9}, {3.7726272472437*^9, 
   3.772627317946089*^9}, {3.772627351991897*^9, 3.772627383050082*^9}, 
   3.77262742718675*^9, 3.772627482351563*^9, {3.772627521804685*^9, 
   3.772627565815549*^9}, {3.772627970921803*^9, 3.772627993530748*^9}, 
   3.772688101762364*^9, 3.77277831286942*^9, 3.77277868380354*^9, {
   3.773314041221697*^9, 3.773314045673312*^9}, 3.77331872348147*^9, 
   3.773318977389785*^9, {3.773319091568604*^9, 3.773319115200382*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"C = (\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\", \"\>", "\[InvisibleSpace]", "5", 
   "\[InvisibleSpace]", "\<\")\"\>"}],
  SequenceForm["C = (", 1, ", ", 5, ")"],
  Editable->False]], "Print",
 CellChangeTimes->{{3.7726268723921947`*^9, 3.772626886422524*^9}, 
   3.772627056840578*^9, 3.7726270991070747`*^9, 3.772627130174691*^9, {
   3.772627179245577*^9, 3.772627186072956*^9}, {3.7726272472437*^9, 
   3.772627317946089*^9}, {3.772627351991897*^9, 3.772627383050082*^9}, 
   3.77262742718675*^9, 3.772627482351563*^9, {3.772627521804685*^9, 
   3.772627565815549*^9}, {3.772627970921803*^9, 3.772627993530748*^9}, 
   3.772688101762364*^9, 3.77277831286942*^9, 3.77277868380354*^9, {
   3.773314041221697*^9, 3.773314045673312*^9}, 3.77331872348147*^9, 
   3.773318977389785*^9, {3.773319091568604*^9, 3.773319115211269*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ReKey = \"\>", "\[InvisibleSpace]", "15"}],
  SequenceForm["ReKey = ", 15],
  Editable->False]], "Print",
 CellChangeTimes->{{3.7726268723921947`*^9, 3.772626886422524*^9}, 
   3.772627056840578*^9, 3.7726270991070747`*^9, 3.772627130174691*^9, {
   3.772627179245577*^9, 3.772627186072956*^9}, {3.7726272472437*^9, 
   3.772627317946089*^9}, {3.772627351991897*^9, 3.772627383050082*^9}, 
   3.77262742718675*^9, 3.772627482351563*^9, {3.772627521804685*^9, 
   3.772627565815549*^9}, {3.772627970921803*^9, 3.772627993530748*^9}, 
   3.772688101762364*^9, 3.77277831286942*^9, 3.77277868380354*^9, {
   3.773314041221697*^9, 3.773314045673312*^9}, 3.77331872348147*^9, 
   3.773318977389785*^9, {3.773319091568604*^9, 3.7733191152224007`*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Entschl\[UDoubleDot]sselung", " ", "aus", " ", "Sicht", " ", "von", " ", 
    "A"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Mod", "[", 
   RowBox[{
    RowBox[{"CipherText2A", "*", 
     RowBox[{"getModularMultiplicativeInverse", "[", 
      RowBox[{
       RowBox[{"CipherText1A", "^", "sKa"}], ",", "p"}], "]"}]}], ",", "p"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.772609186731023*^9, 3.772609353920347*^9}, {
   3.772609960801903*^9, 3.772609977138116*^9}, {3.772610012060671*^9, 
   3.772610037869439*^9}, {3.772610075423439*^9, 3.772610090455678*^9}, {
   3.7726101835685253`*^9, 3.7726101900634327`*^9}, {3.7726103172522717`*^9, 
   3.772610321955801*^9}, {3.772611628570178*^9, 3.772611645210485*^9}, {
   3.7726117206055717`*^9, 3.772611762822462*^9}, {3.772611811999611*^9, 
   3.772611893267371*^9}, {3.772611944502269*^9, 3.77261206241536*^9}, {
   3.772612104272614*^9, 3.772612160194619*^9}, {3.7726122118673487`*^9, 
   3.772612242214304*^9}, {3.772612280630541*^9, 3.772612299325519*^9}, {
   3.77261315283879*^9, 3.772613178529117*^9}, {3.772613282060227*^9, 
   3.77261333561911*^9}, {3.7726134583996363`*^9, 3.772613468694418*^9}, {
   3.772613510552594*^9, 3.772613558273136*^9}, {3.772613673141362*^9, 
   3.772613740527129*^9}, {3.772613873467681*^9, 3.772613892979403*^9}, {
   3.772613992895233*^9, 3.772614036464569*^9}, {3.772614134460535*^9, 
   3.772614307841299*^9}, {3.772614345532104*^9, 3.77261438273652*^9}, {
   3.7726149937398043`*^9, 3.772615022308352*^9}, {3.77262459490696*^9, 
   3.77262470037214*^9}, {3.772624867172802*^9, 3.772624872762433*^9}, {
   3.772625897776733*^9, 3.7726259014696817`*^9}, 3.773318970938183*^9}],

Cell[BoxData["5"], "Output",
 CellChangeTimes->{{3.772614388874078*^9, 3.772614424771596*^9}, 
   3.772614488564158*^9, 3.7726145647156477`*^9, {3.7726148676366453`*^9, 
   3.7726148736020308`*^9}, {3.772614949335754*^9, 3.772614963498966*^9}, {
   3.7726150192163*^9, 3.772615089174114*^9}, {3.772615274498014*^9, 
   3.77261534991625*^9}, {3.7726154088484993`*^9, 3.772615442424884*^9}, 
   3.7726155219936857`*^9, {3.772615599769837*^9, 3.7726156080251083`*^9}, {
   3.772622687945763*^9, 3.772622709071434*^9}, 3.772623072887018*^9, 
   3.7726231620711393`*^9, 3.772623226387035*^9, {3.7726232639105053`*^9, 
   3.772623279156459*^9}, 3.772623327152763*^9, {3.772623453244101*^9, 
   3.7726234794039183`*^9}, {3.772623675282078*^9, 3.772623718761909*^9}, 
   3.772624340785729*^9, 3.772624370876286*^9, {3.7726244226122007`*^9, 
   3.772624433616539*^9}, 3.772624487740716*^9, {3.77262453594165*^9, 
   3.772624561503399*^9}, 3.772624598316401*^9, {3.772624649238636*^9, 
   3.7726246810507383`*^9}, 3.7726247179753113`*^9, {3.772624892514673*^9, 
   3.772624932489418*^9}, 3.772625030515362*^9, {3.7726251219289227`*^9, 
   3.772625144892126*^9}, 3.7726252283789062`*^9, {3.772625355019435*^9, 
   3.7726253660507727`*^9}, 3.772625504953032*^9, {3.772625677334652*^9, 
   3.7726256899009027`*^9}, 3.772625806548664*^9, 3.772625916128097*^9, {
   3.772626805980537*^9, 3.772626886568619*^9}, 3.772627056998765*^9, 
   3.772627099259103*^9, 3.772627130319325*^9, {3.772627179408799*^9, 
   3.772627186225007*^9}, {3.772627247473297*^9, 3.772627318144094*^9}, {
   3.772627352173354*^9, 3.772627383200386*^9}, 3.772627427374804*^9, 
   3.772627482515193*^9, {3.7726275219725113`*^9, 3.7726275660136833`*^9}, {
   3.772627971071081*^9, 3.772627993683434*^9}, 3.772688101897502*^9, 
   3.772778313035575*^9, 3.772778683948545*^9, {3.7733140413877974`*^9, 
   3.7733140458222837`*^9}, 3.7733187236557083`*^9, 3.7733189775851927`*^9, {
   3.773319091717811*^9, 3.7733191153132343`*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"Proxy", " ", "Re"}], "-", 
     RowBox[{"Encryption", " ", "A"}]}], " ", "\[Rule]", " ", "B"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"CipherText1B", " ", "=", " ", 
     RowBox[{"Mod", "[", 
      RowBox[{
       RowBox[{"CipherText1A", "^", "rekAB"}], ",", "p"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CipherText2B", " ", "=", " ", "CipherText2A"}], ";"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJwd0E8oQwEABvDnTyMXGlZmJdnVspuUV6/8KbRYq9WS0BxsyRrtgJLDTGLZ
a3ZaTDFTNn+ipc0YqUlm76VmNMXBwZ4tFJcV73uHr1/f5Tt89cPj6pFCgiCk
fOCiXqsJ1HLUzETrKGzaqTmGZqM8CIs/50JCZ0MRmFgau4TvTtUV7Fd+JeBm
yQUD3WLfC+RWyVf4RtLWPd7usNcGHwYrHdDdp3PBRH7WDVV2nxe6xBV+uNF1
G4LUSWkUqltEMcHodBw6nzpYqG+sSsJtgyEFB5LStn1eW7a3Ew59UBp4fvet
g+x1jwHuNruM8DHAmODCacwCy+blVkg+rywL/irWYLt23SPsbMn8gmn7ITwK
xyOQy0zdwz+RMgVpRzINzWe5DMxOanNQUuTJQ02AIQ546xQN4iB+pm8ELeU/
1QUyjnKY4hL4D6wG1Xg=
  "]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Entschl\[UDoubleDot]sselung", " ", "aus", " ", "Sicht", " ", "von", " ", 
    "B"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Mod", "[", 
   RowBox[{
    RowBox[{"CipherText2B", "*", 
     RowBox[{"getModularMultiplicativeInverse", "[", 
      RowBox[{
       RowBox[{"CipherText1B", "^", "sKb"}], ",", "p"}], "]"}]}], ",", "p"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.772614532542741*^9, 3.7726145613421926`*^9}, {
   3.772614848833424*^9, 3.7726148524310637`*^9}, {3.77262487797136*^9, 
   3.772624902905992*^9}, {3.772627123979664*^9, 3.7726271265160303`*^9}, 
   3.773318970899*^9}],

Cell[BoxData["5"], "Output",
 CellChangeTimes->{
  3.7726145648153553`*^9, {3.7726148613898563`*^9, 3.772614873715983*^9}, {
   3.77261494940623*^9, 3.772614963581831*^9}, {3.772615019292779*^9, 
   3.772615089274549*^9}, {3.7726152745845823`*^9, 3.772615349984569*^9}, {
   3.772615408948892*^9, 3.7726154425390577`*^9}, 3.77261552208915*^9, {
   3.7726155998566*^9, 3.772615608121971*^9}, {3.772622688021162*^9, 
   3.772622709150928*^9}, 3.7726230729579163`*^9, 3.772623162141096*^9, 
   3.77262322646209*^9, {3.772623263987365*^9, 3.772623279234068*^9}, 
   3.77262332725408*^9, {3.772623453328928*^9, 3.7726234794893007`*^9}, {
   3.772623675351747*^9, 3.7726237188623133`*^9}, 3.772624340870373*^9, 
   3.7726243709655647`*^9, {3.772624422703052*^9, 3.7726244336858063`*^9}, 
   3.7726244878392057`*^9, {3.77262453601825*^9, 3.7726245615820503`*^9}, 
   3.772624598414483*^9, {3.77262464937676*^9, 3.772624681181014*^9}, 
   3.772624718055339*^9, {3.7726248926081457`*^9, 3.772624932588299*^9}, 
   3.772625030591012*^9, {3.772625122005623*^9, 3.772625144966713*^9}, 
   3.772625228479701*^9, {3.7726253551184597`*^9, 3.7726253661316566`*^9}, 
   3.772625505055504*^9, {3.772625677454414*^9, 3.772625690001264*^9}, 
   3.772625806630991*^9, 3.772625916229261*^9, {3.772626806082281*^9, 
   3.772626886668766*^9}, 3.7726270571192627`*^9, 3.772627099378014*^9, 
   3.772627130415833*^9, {3.772627179507538*^9, 3.772627186324834*^9}, {
   3.772627247580261*^9, 3.772627318248988*^9}, {3.7726273522740993`*^9, 
   3.772627383300995*^9}, 3.772627427503366*^9, 3.772627482631914*^9, {
   3.7726275220734453`*^9, 3.772627566114966*^9}, {3.7726279711725607`*^9, 
   3.772627993783677*^9}, 3.7726881019969463`*^9, 3.772778313115583*^9, 
   3.772778684048053*^9, {3.773314041489291*^9, 3.773314045929112*^9}, 
   3.7733187237417*^9, 3.7733189776883507`*^9, {3.7733190918035297`*^9, 
   3.7733191154141083`*^9}}]
}, Open  ]]
},
WindowSize->{640, 719},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"11.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (July 28, \
2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 4188, 93, 523, "Input"],
Cell[CellGroupData[{
Cell[4771, 117, 6262, 150, 733, "Input"],
Cell[CellGroupData[{
Cell[11058, 271, 802, 13, 24, "Print"],
Cell[11863, 286, 873, 14, 24, "Print"],
Cell[12739, 302, 1761, 28, 63, "Print"],
Cell[14503, 332, 784, 13, 24, "Print"],
Cell[15290, 347, 1042, 16, 24, "Print"],
Cell[16335, 365, 784, 13, 24, "Print"],
Cell[17122, 380, 901, 15, 24, "Print"],
Cell[18026, 397, 794, 13, 24, "Print"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[18869, 416, 1728, 30, 90, "Input"],
Cell[20600, 448, 1984, 27, 32, "Output"]
}, Open  ]],
Cell[22599, 478, 1033, 27, 111, "Input"],
Cell[CellGroupData[{
Cell[23657, 509, 652, 16, 90, "Input"],
Cell[24312, 527, 1907, 27, 66, "Output"]
}, Open  ]]
}
]
*)

